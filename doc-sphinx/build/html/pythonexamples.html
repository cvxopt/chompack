

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Python Examples &mdash; CHOMPACK</title>
    <link rel="stylesheet" href="_static/cvxopt.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="copyright" title="Copyright" href="copyright.html" />
    <link rel="top" title="CHOMPACK" href="index.html" />
    <link rel="next" title="C Interface" href="capi.html" />
    <link rel="prev" title="Python Interface" href="pythonapi.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="capi.html" title="C Interface"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="pythonapi.html" title="Python Interface"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">CHOMPACK - Chordal Matrix Package</a> </li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="python-examples">
<span id="pythonexamples"></span><h1>Python Examples<a class="headerlink" href="#python-examples" title="Permalink to this headline">¶</a></h1>
<p>In this chapter we illustrate the functions in the library with some simple
examples.</p>
<div class="section" id="chordal-matrices">
<h2>Chordal matrices<a class="headerlink" href="#chordal-matrices" title="Permalink to this headline">¶</a></h2>
<p>We start by creating a 10 by 10 sparse symmetric matrix.</p>
<div class="math" id="equation-chordal_X">
<p><span class="eqno">(1)</span><img src="_images/math/100a1b11d1bb0a6b4a9eb150e5c73a2e241801fa.png" alt="A = \left[ \begin{array}{cccccccccc}
  4.86 &amp; 0    &amp; 0    &amp;  0     &amp;  0    &amp; -2.60  &amp;  0    &amp;  0     &amp; 0    &amp;  0    \\
  0    &amp; 5.13 &amp; 0    &amp;  0     &amp;  0    &amp;  0     &amp;  0    &amp;  0     &amp; 0    &amp;  0    \\
  0    &amp; 0    &amp; 5.03 &amp;  1.29  &amp;  1.41 &amp;  0     &amp;  0    &amp;  2.05  &amp; 0    &amp;  0.04 \\
  0    &amp; 0    &amp; 1.29 &amp;  0.99  &amp;  0    &amp;  0     &amp;  0    &amp;  0     &amp; 0    &amp; -0.79 \\
  0    &amp; 0    &amp; 1.41 &amp;  0     &amp;  5.45 &amp;  0     &amp;  0    &amp;  0     &amp; 0    &amp;  0    \\
 -2.60 &amp; 0    &amp; 0    &amp;  0     &amp;  0    &amp;  2.60  &amp;  0.17 &amp;  0     &amp; 0    &amp;  0    \\
  0    &amp; 0    &amp; 0    &amp;  0     &amp;  0    &amp;  0.17  &amp;  1.16 &amp;  0     &amp; 0    &amp;  0    \\
  0    &amp; 0    &amp; 2.05 &amp;  0     &amp;  0    &amp;  0     &amp;  0    &amp;  1.64  &amp; 0    &amp;  0.21 \\
  0    &amp; 0    &amp; 0    &amp;  0     &amp;  0    &amp;  0     &amp;  0    &amp;  0     &amp; 2.48 &amp;  0    \\
  0    &amp; 0    &amp; 0.04 &amp; -0.79  &amp;  0    &amp;  0     &amp;  0    &amp;  0.21  &amp; 0    &amp;  4.21
 \end{array}\right ]" /></p>
</div><div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">cvxopt</span> <span class="kn">import</span> <span class="n">matrix</span><span class="p">,</span> <span class="n">spmatrix</span><span class="p">,</span> <span class="n">printing</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">printing</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s">&#39;width&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span> <span class="o">=</span> <span class="p">[</span><span class="mf">4.86</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.60</span><span class="p">,</span> <span class="mf">5.13</span><span class="p">,</span> <span class="mf">5.03</span><span class="p">,</span> <span class="mf">1.29</span><span class="p">,</span> <span class="mf">1.41</span><span class="p">,</span> <span class="mf">2.05</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.79</span><span class="p">,</span> <span class="mf">5.45</span><span class="p">,</span> <span class="mf">2.60</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">1.16</span><span class="p">,</span> <span class="mf">1.64</span><span class="p">,</span> <span class="mf">0.21</span><span class="p">,</span> <span class="mf">2.48</span><span class="p">,</span> <span class="mf">4.21</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">I</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span>     <span class="mi">5</span><span class="p">,</span>    <span class="mi">1</span><span class="p">,</span>    <span class="mi">2</span><span class="p">,</span>    <span class="mi">3</span><span class="p">,</span>    <span class="mi">4</span><span class="p">,</span>    <span class="mi">7</span><span class="p">,</span>    <span class="mi">9</span><span class="p">,</span>    <span class="mi">3</span><span class="p">,</span>     <span class="mi">9</span><span class="p">,</span>    <span class="mi">4</span><span class="p">,</span>    <span class="mi">5</span><span class="p">,</span>    <span class="mi">6</span><span class="p">,</span>    <span class="mi">6</span><span class="p">,</span>    <span class="mi">7</span><span class="p">,</span>    <span class="mi">9</span><span class="p">,</span>    <span class="mi">8</span><span class="p">,</span>    <span class="mi">9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">J</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span>     <span class="mi">0</span><span class="p">,</span>    <span class="mi">1</span><span class="p">,</span>    <span class="mi">2</span><span class="p">,</span>    <span class="mi">2</span><span class="p">,</span>    <span class="mi">2</span><span class="p">,</span>    <span class="mi">2</span><span class="p">,</span>    <span class="mi">2</span><span class="p">,</span>    <span class="mi">3</span><span class="p">,</span>     <span class="mi">3</span><span class="p">,</span>    <span class="mi">4</span><span class="p">,</span>    <span class="mi">5</span><span class="p">,</span>    <span class="mi">5</span><span class="p">,</span>    <span class="mi">6</span><span class="p">,</span>    <span class="mi">7</span><span class="p">,</span>    <span class="mi">7</span><span class="p">,</span>    <span class="mi">8</span><span class="p">,</span>    <span class="mi">9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">spmatrix</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">J</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">A</span>
<span class="go">[ 4.86e+00     0         0         0         0         0         0         0         0         0    ]</span>
<span class="go">[    0      5.13e+00     0         0         0         0         0         0         0         0    ]</span>
<span class="go">[    0         0      5.03e+00     0         0         0         0         0         0         0    ]</span>
<span class="go">[    0         0      1.29e+00  9.90e-01     0         0         0         0         0         0    ]</span>
<span class="go">[    0         0      1.41e+00     0      5.45e+00     0         0         0         0         0    ]</span>
<span class="go">[-2.60e+00     0         0         0         0      2.60e+00     0         0         0         0    ]</span>
<span class="go">[    0         0         0         0         0      1.70e-01  1.16e+00     0         0         0    ]</span>
<span class="go">[    0         0      2.05e+00     0         0         0         0      1.64e+00     0         0    ]</span>
<span class="go">[    0         0         0         0         0         0         0         0      2.48e+00     0    ]</span>
<span class="go">[    0         0      4.00e-02 -7.90e-01     0         0         0      2.10e-01     0      4.21e+00]</span>
</pre></div>
</div>
<p>The natural ordering is not a perfect elimination ordering for this matrix,
as can be verified by calling the function <a class="reference internal" href="pythonapi.html#peo" title="peo"><tt class="xref py py-func docutils literal"><span class="pre">peo</span></tt></a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">chompack</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chompack</span><span class="o">.</span><span class="n">peo</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">matrix</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>
<span class="go">False</span>
</pre></div>
</div>
<p>However, the matrix is chordal, and we can find a perfect elmination
ordering via the maximum cardinality search algorithm.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="n">chompack</span><span class="o">.</span><span class="n">maxcardsearch</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">p1</span>
<span class="go">[ 1]</span>
<span class="go">[ 0]</span>
<span class="go">[ 5]</span>
<span class="go">[ 6]</span>
<span class="go">[ 8]</span>
<span class="go">[ 4]</span>
<span class="go">[ 7]</span>
<span class="go">[ 3]</span>
<span class="go">[ 2]</span>
<span class="go">[ 9]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chompack</span><span class="o">.</span><span class="n">peo</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">p1</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Equivalently, the natural ordering is a perfect elimination ordering for
the permuted matrix <cite>A[p1, p1]</cite>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">chompack</span><span class="o">.</span><span class="n">peo</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">p1</span><span class="p">,</span> <span class="n">p1</span><span class="p">],</span> <span class="n">matrix</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Another perfect elimination ordering is defined below.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span> <span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chompack</span><span class="o">.</span><span class="n">peo</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chompack</span><span class="o">.</span><span class="n">peo</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">p2</span><span class="p">,</span> <span class="n">p2</span><span class="p">],</span> <span class="n">matrix</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Next, we use the <a class="reference internal" href="pythonapi.html#embed" title="embed"><tt class="xref py py-func docutils literal"><span class="pre">embed</span></tt></a> function to convert <cite>A</cite> to a chordal
matrix.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">Ac</span><span class="p">,</span> <span class="n">nfill</span> <span class="o">=</span> <span class="n">chompack</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">p1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">Ac</span>
<span class="go">&lt;PyCObject object at 0x7f07853bd170&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">nfill</span>
<span class="go">0</span>
</pre></div>
</div>
<p>The created chordal matrix object <cite>Ac</cite> is an opaque C object, containing
the sparsity pattern and the numerical values of <cite>A</cite>, and the permutation
used to create <cite>Ac</cite>.  The variable <cite>nfill</cite> shows that no fill-in was
produced when embedding the sparsity pattern of <cite>A</cite> in a chordal pattern.
This confirms that <cite>p1</cite> is indeed a perfect elimination ordering.</p>
<p>The chordal matrix can be converted back to CVXOPT using the
<a class="reference internal" href="pythonapi.html#sparse" title="sparse"><tt class="xref py py-func docutils literal"><span class="pre">sparse</span></tt></a> function.  <a class="reference internal" href="pythonapi.html#sparse" title="sparse"><tt class="xref py py-func docutils literal"><span class="pre">sparse</span></tt></a> returns the lower triangular part
of the matrix.  If needed, the <a class="reference internal" href="pythonapi.html#symmetrize" title="symmetrize"><tt class="xref py py-func docutils literal"><span class="pre">symmetrize</span></tt></a> function provides an
efficient method for converting the lower triangular matrix to symmetric.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">chompack</span><span class="o">.</span><span class="n">sparse</span><span class="p">(</span><span class="n">Ac</span><span class="p">)</span>
<span class="go">[ 4.86e+00     0         0         0         0         0         0         0         0         0    ]</span>
<span class="go">[    0      5.13e+00     0         0         0         0         0         0         0         0    ]</span>
<span class="go">[    0         0      5.03e+00     0         0         0         0         0         0         0    ]</span>
<span class="go">[    0         0      1.29e+00  9.90e-01     0         0         0         0         0         0    ]</span>
<span class="go">[    0         0      1.41e+00     0      5.45e+00     0         0         0         0         0    ]</span>
<span class="go">[-2.60e+00     0         0         0         0      2.60e+00     0         0         0         0    ]</span>
<span class="go">[    0         0         0         0         0      1.70e-01  1.16e+00     0         0         0    ]</span>
<span class="go">[    0         0      2.05e+00     0         0         0         0      1.64e+00     0         0    ]</span>
<span class="go">[    0         0         0         0         0         0         0         0      2.48e+00     0    ]</span>
<span class="go">[    0         0      4.00e-02 -7.90e-01     0         0         0      2.10e-01     0      4.21e+00]</span>


<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">chompack</span><span class="o">.</span><span class="n">symmetrize</span><span class="p">(</span><span class="n">chompack</span><span class="o">.</span><span class="n">sparse</span><span class="p">(</span><span class="n">Ac</span><span class="p">))</span>
<span class="go">[ 4.86e+00     0         0         0         0     -2.60e+00     0         0         0         0    ]</span>
<span class="go">[    0      5.13e+00     0         0         0         0         0         0         0         0    ]</span>
<span class="go">[    0         0      5.03e+00  1.29e+00  1.41e+00     0         0      2.05e+00     0      4.00e-02]</span>
<span class="go">[    0         0      1.29e+00  9.90e-01     0         0         0         0         0     -7.90e-01]</span>
<span class="go">[    0         0      1.41e+00     0      5.45e+00     0         0         0         0         0    ]</span>
<span class="go">[-2.60e+00     0         0         0         0      2.60e+00  1.70e-01     0         0         0    ]</span>
<span class="go">[    0         0         0         0         0      1.70e-01  1.16e+00     0         0         0    ]</span>
<span class="go">[    0         0      2.05e+00     0         0         0         0      1.64e+00     0      2.10e-01]</span>
<span class="go">[    0         0         0         0         0         0         0         0      2.48e+00     0    ]</span>
<span class="go">[    0         0      4.00e-02 -7.90e-01     0         0         0      2.10e-01     0      4.21e+00]</span>
</pre></div>
</div>
<p>If we wish to create another chordal matrix with the same sparsity
pattern as <cite>Ac</cite>, but different numerical values, we use the <a class="reference internal" href="pythonapi.html#project" title="project"><tt class="xref py py-func docutils literal"><span class="pre">project</span></tt></a>
function.  In the following code, we create a chordal matrix <cite>Bc</cite> with
the same sparsity pattern as <cite>Ac</cite>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">Bc</span> <span class="o">=</span> <span class="n">chompack</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="n">Ac</span><span class="p">,</span> <span class="n">matrix</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="s">&#39;d&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">chompack</span><span class="o">.</span><span class="n">sparse</span><span class="p">(</span><span class="n">Bc</span><span class="p">)</span>
<span class="go">[ 0.00e+00     0         0         0         0         0         0         0         0         0    ]</span>
<span class="go">[    0      1.10e+01     0         0         0         0         0         0         0         0    ]</span>
<span class="go">[    0         0      2.20e+01     0         0         0         0         0         0         0    ]</span>
<span class="go">[    0         0      3.20e+01  3.30e+01     0         0         0         0         0         0    ]</span>
<span class="go">[    0         0      4.20e+01     0      4.40e+01     0         0         0         0         0    ]</span>
<span class="go">[ 5.00e+00     0         0         0         0      5.50e+01     0         0         0         0    ]</span>
<span class="go">[    0         0         0         0         0      5.60e+01  6.60e+01     0         0         0    ]</span>
<span class="go">[    0         0      7.20e+01     0         0         0         0      7.70e+01     0         0    ]</span>
<span class="go">[    0         0         0         0         0         0         0         0      8.80e+01     0    ]</span>
<span class="go">[    0         0      2.90e+01  3.90e+01     0         0         0      7.90e+01     0      9.90e+01]</span>
</pre></div>
</div>
<p>The function <a class="reference internal" href="pythonapi.html#project" title="project"><tt class="xref py py-func docutils literal"><span class="pre">project</span></tt></a> projects the dense or sparse matrix given as
second argument onto the chordal sparsity pattern defined by <cite>Ac</cite>.
The chordal matrix object <cite>Bc</cite> reuses the data structure of <cite>Ac</cite>
(except, obviously, for the numerical values of the nonzeros), and will
therefore be recognized by other functions as having the same sparsity
pattern as <cite>Ac</cite>.
It is important to understand that only chordal matrices derived from
the same chordal matrix object (for example, using <a class="reference internal" href="pythonapi.html#project" title="project"><tt class="xref py py-func docutils literal"><span class="pre">project</span></tt></a>) are
recognized as having the same sparsity pattern.
If we had created the <cite>Bc</cite> using the <a class="reference internal" href="pythonapi.html#embed" title="embed"><tt class="xref py py-func docutils literal"><span class="pre">embed</span></tt></a> function, for example,
the chordal matrices <cite>Bc</cite> and <cite>Ac</cite> would not be recognized as having the
same sparsity pattern.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">Bc</span><span class="p">,</span> <span class="n">nfill</span> <span class="o">=</span> <span class="n">chompack</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">spmatrix</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">A</span><span class="o">.</span><span class="n">I</span><span class="p">,</span> <span class="n">A</span><span class="o">.</span><span class="n">J</span><span class="p">),</span> <span class="n">p1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">chompack</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Ac</span><span class="p">,</span> <span class="n">Bc</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">TypeError</span>: <span class="n">X and Y must have the same chordal pattern</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bc</span> <span class="o">=</span> <span class="n">chompack</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="n">Ac</span><span class="p">,</span> <span class="n">spmatrix</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">A</span><span class="o">.</span><span class="n">I</span><span class="p">,</span> <span class="n">A</span><span class="o">.</span><span class="n">J</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">chompack</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Ac</span><span class="p">,</span> <span class="n">Bc</span><span class="p">)</span>
<span class="go">37.11</span>
</pre></div>
</div>
<p>Returning to the chordal embedding, let us look at the result of converting
<cite>A</cite> to a chordal matrix object, using the (default) natural ordering:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">Ac2</span><span class="p">,</span> <span class="n">nfill2</span> <span class="o">=</span> <span class="n">chompack</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nfill2</span>
<span class="go">4</span>
</pre></div>
</div>
<p>The natural ordering is not a perfect elimination ordering for <cite>A</cite>, so
some fill-in is necessary to embed the sparsity pattern in a chordal
pattern that has the natural ordering as a perfect elimination ordering.
If we convert the embedded matrix back to CVXOPT we notice the four
new nonzero positions in columns 4 and 5.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">chompack</span><span class="o">.</span><span class="n">sparse</span><span class="p">(</span><span class="n">Ac2</span><span class="p">)</span>
<span class="go">[ 4.86e+00     0         0         0         0         0         0         0         0         0    ]</span>
<span class="go">[    0      5.13e+00     0         0         0         0         0         0         0         0    ]</span>
<span class="go">[    0         0      5.03e+00     0         0         0         0         0         0         0    ]</span>
<span class="go">[    0         0      1.29e+00  9.90e-01     0         0         0         0         0         0    ]</span>
<span class="go">[    0         0      1.41e+00  0.00e+00  5.45e+00     0         0         0         0         0    ]</span>
<span class="go">[-2.60e+00     0         0         0         0      2.60e+00     0         0         0         0    ]</span>
<span class="go">[    0         0         0         0         0      1.70e-01  1.16e+00     0         0         0    ]</span>
<span class="go">[    0         0      2.05e+00  0.00e+00  0.00e+00     0         0      1.64e+00     0         0    ]</span>
<span class="go">[    0         0         0         0         0         0         0         0      2.48e+00     0    ]</span>
<span class="go">[    0         0      4.00e-02 -7.90e-01  0.00e+00     0         0      2.10e-01     0      4.21e+00]</span>
</pre></div>
</div>
<p>As another example, consider the following matrix with <em>non-chordal</em>
sparsity pattern</p>
<div class="math">
<p><img src="_images/math/6601db0ddf0863e2fc92c07dab647e0495184d38.png" alt="B = \left[\begin{array}{cccc}
  1 &amp; 1 &amp;  1 &amp; 0\\
  1 &amp; 1 &amp;  0 &amp; 1\\
  1 &amp; 0  &amp; 1 &amp; 1\\
  0 &amp; 1  &amp; 1 &amp; 1
\end{array}\right]." /></p>
</div><p>A chordal embedding of <cite>B</cite> will always produce fill-in.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">spmatrix</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bc</span><span class="p">,</span> <span class="n">nfill</span> <span class="o">=</span> <span class="n">chompack</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">chompack</span><span class="o">.</span><span class="n">maxcardsearch</span><span class="p">(</span><span class="n">B</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nfill</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">chompack</span><span class="o">.</span><span class="n">sparse</span><span class="p">(</span><span class="n">Bc</span><span class="p">)</span>
<span class="go">[ 1.00e+00     0         0         0    ]</span>
<span class="go">[ 1.00e+00  1.00e+00     0         0    ]</span>
<span class="go">[ 1.00e+00     0      1.00e+00     0    ]</span>
<span class="go">[ 0.00e+00  1.00e+00  1.00e+00  1.00e+00]</span>
</pre></div>
</div>
<p>In other words, the <em>maximum cardinality search</em> ordering for <cite>B</cite> is not
a perfect elimination order</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">chompack</span><span class="o">.</span><span class="n">peo</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">chompack</span><span class="o">.</span><span class="n">maxcardsearch</span><span class="p">(</span><span class="n">B</span><span class="p">))</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
<div class="section" id="cholesky-factorization">
<h2>Cholesky factorization<a class="headerlink" href="#cholesky-factorization" title="Permalink to this headline">¶</a></h2>
<p>The matrix <img class="math" src="_images/math/019e9892786e493964e145e7c5cf7b700314e53b.png" alt="A"/> in <a href="#equation-chordal_X">(1)</a> can be factored as</p>
<div class="math">
<p><img src="_images/math/a590ed1b6d00a23a152bbaf3b9160adeae9ff608.png" alt="A = PLL^TP^T" /></p>
</div><p>using the <a class="reference internal" href="pythonapi.html#cholesky" title="cholesky"><tt class="xref py py-func docutils literal"><span class="pre">cholesky</span></tt></a> function.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="n">chompack</span><span class="o">.</span><span class="n">cholesky</span><span class="p">(</span><span class="n">Ac</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">chompack</span><span class="o">.</span><span class="n">sparse</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="go">[ 2.26e+00     0         0         0         0         0         0         0         0         0    ]</span>
<span class="go">[    0      2.20e+00     0         0         0         0         0         0         0         0    ]</span>
<span class="go">[    0     -1.18e+00  1.10e+00     0         0         0         0         0         0         0    ]</span>
<span class="go">[    0         0      1.55e-01  1.07e+00     0         0         0         0         0         0    ]</span>
<span class="go">[    0         0         0         0      1.57e+00     0         0         0         0         0    ]</span>
<span class="go">[    0         0         0         0         0      2.33e+00     0         0         0         0    ]</span>
<span class="go">[    0         0         0         0         0         0      1.28e+00     0         0         0    ]</span>
<span class="go">[    0         0         0         0         0         0         0      9.95e-01     0         0    ]</span>
<span class="go">[    0         0         0         0         0      6.04e-01  1.60e+00  1.30e+00  6.49e-01     0    ]</span>
<span class="go">[    0         0         0         0         0         0      1.64e-01 -7.94e-01  1.24e+00  1.42e+00]</span>
</pre></div>
</div>
<p>Comparing the sparsity pattern of <cite>L</cite> with the sparsity pattern of
<cite>A[p1, p1]</cite>, ie, as the matrix <img class="math" src="_images/math/bf6914a1cbba2e36d149f6ed9c555f045c084f1d.png" alt="P^TAP"/>, shows that no fill-in
occurred during the factorization.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">chompack</span><span class="o">.</span><span class="n">symmetrize</span><span class="p">(</span><span class="n">A</span><span class="p">)[</span><span class="n">p1</span><span class="p">,</span> <span class="n">p1</span><span class="p">]</span>
<span class="go">[ 5.13e+00     0         0         0         0         0         0         0         0         0    ]</span>
<span class="go">[    0      4.86e+00 -2.60e+00     0         0         0         0         0         0         0    ]</span>
<span class="go">[    0     -2.60e+00  2.60e+00  1.70e-01     0         0         0         0         0         0    ]</span>
<span class="go">[    0         0      1.70e-01  1.16e+00     0         0         0         0         0         0    ]</span>
<span class="go">[    0         0         0         0      2.48e+00     0         0         0         0         0    ]</span>
<span class="go">[    0         0         0         0         0      5.45e+00     0         0      1.41e+00     0    ]</span>
<span class="go">[    0         0         0         0         0         0      1.64e+00     0      2.05e+00  2.10e-01]</span>
<span class="go">[    0         0         0         0         0         0         0      9.90e-01  1.29e+00 -7.90e-01]</span>
<span class="go">[    0         0         0         0         0      1.41e+00  2.05e+00  1.29e+00  5.03e+00  4.00e-02]</span>
<span class="go">[    0         0         0         0         0         0      2.10e-01 -7.90e-01  4.00e-02  4.21e+00]</span>
</pre></div>
</div>
<p>We can verify the correctness of the factorization by computing the
matrix <img class="math" src="_images/math/e2efbb9d5939294a17ea29268161663363bfeb34.png" alt="PLL^TP^T"/> and comparing with <img class="math" src="_images/math/019e9892786e493964e145e7c5cf7b700314e53b.png" alt="A"/>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">chompack</span><span class="o">.</span><span class="n">sparse</span><span class="p">(</span> <span class="n">chompack</span><span class="o">.</span><span class="n">llt</span><span class="p">(</span><span class="n">L</span><span class="p">)</span> <span class="p">)</span>
<span class="go">[ 4.86e+00     0         0         0         0         0         0         0         0         0    ]</span>
<span class="go">[    0      5.13e+00     0         0         0         0         0         0         0         0    ]</span>
<span class="go">[    0         0      5.03e+00     0         0         0         0         0         0         0    ]</span>
<span class="go">[    0         0      1.29e+00  9.90e-01     0         0         0         0         0         0    ]</span>
<span class="go">[    0         0      1.41e+00     0      5.45e+00     0         0         0         0         0    ]</span>
<span class="go">[-2.60e+00     0         0         0         0      2.60e+00     0         0         0         0    ]</span>
<span class="go">[    0         0         0         0         0      1.70e-01  1.16e+00     0         0         0    ]</span>
<span class="go">[    0         0      2.05e+00     0         0         0         0      1.64e+00     0         0    ]</span>
<span class="go">[    0         0         0         0         0         0         0         0      2.48e+00     0    ]</span>
<span class="go">[    0         0      4.00e-02 -7.90e-01     0         0         0      2.10e-01     0      4.21e+00]</span>
</pre></div>
</div>
<p>Now suppose we wish to solve a linear equation</p>
<div class="math">
<p><img src="_images/math/55f3fc878003c68964c0499a438203fbccc00f33.png" alt="Ax = b." /></p>
</div><p>This can be done via two calls to the <a class="reference internal" href="pythonapi.html#solve" title="solve"><tt class="xref py py-func docutils literal"><span class="pre">solve</span></tt></a> function.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chompack</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chompack</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">x</span>
<span class="go">[ 8.33e-01]</span>
<span class="go">[ 1.95e-01]</span>
<span class="go">[-9.19e+00]</span>
<span class="go">[ 1.50e+01]</span>
<span class="go">[ 2.56e+00]</span>
<span class="go">[ 1.17e+00]</span>
<span class="go">[ 6.90e-01]</span>
<span class="go">[ 1.18e+01]</span>
<span class="go">[ 4.03e-01]</span>
<span class="go">[ 2.56e+00]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">cvxopt</span> <span class="kn">import</span> <span class="n">blas</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">blas</span><span class="o">.</span><span class="n">nrm2</span><span class="p">(</span><span class="n">chompack</span><span class="o">.</span><span class="n">symmetrize</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="go">4.79713995204e-15</span>
</pre></div>
</div>
</div>
<div class="section" id="partial-inverse">
<h2>Partial inverse<a class="headerlink" href="#partial-inverse" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="pythonapi.html#partial_inv" title="partial_inv"><tt class="xref py py-func docutils literal"><span class="pre">partial_inv</span></tt></a> function evaluates the projected inverse of a
positive definite chordal matrix,</p>
<div class="math" id="equation-partialinv">
<p><span class="eqno">(2)</span><img src="_images/math/b4fb6283835c602ad71da0f9d36777aa742d454b.png" alt="Y = \mathrm{proj}(X^{-1})," /></p>
</div><p><em>i.e.</em>, it computes the entries of the inverse of <img class="math" src="_images/math/6a47ca0fe7cb276abc022af6ac88ddae1a9d6894.png" alt="X"/> in the positions
of the nonzeros of <img class="math" src="_images/math/6a47ca0fe7cb276abc022af6ac88ddae1a9d6894.png" alt="X"/>.  As input, the function uses the Cholesky
factor of <cite>X</cite>.</p>
<p>As an example we compute the partial inverse of the matrix <img class="math" src="_images/math/019e9892786e493964e145e7c5cf7b700314e53b.png" alt="A"/>
in <a href="#equation-chordal_X">(1)</a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span> <span class="o">=</span> <span class="n">chompack</span><span class="o">.</span><span class="n">partial_inv</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">chompack</span><span class="o">.</span><span class="n">sparse</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
<span class="go">[ 4.47e-01     0         0         0         0         0         0         0         0         0    ]</span>
<span class="go">[    0      1.95e-01     0         0         0         0         0         0         0         0    ]</span>
<span class="go">[    0         0      4.19e+00     0         0         0         0         0         0         0    ]</span>
<span class="go">[    0         0     -6.22e+00  1.04e+01     0         0         0         0         0         0    ]</span>
<span class="go">[    0         0     -1.08e+00     0      4.64e-01     0         0         0         0         0    ]</span>
<span class="go">[ 4.52e-01     0         0         0         0      8.44e-01     0         0         0         0    ]</span>
<span class="go">[    0         0         0         0         0     -1.24e-01  8.80e-01     0         0         0    ]</span>
<span class="go">[    0         0     -5.12e+00     0         0         0         0      6.86e+00     0         0    ]</span>
<span class="go">[    0         0         0         0         0         0         0         0      4.03e-01     0    ]</span>
<span class="go">[    0         0     -9.52e-01  1.64e+00     0         0         0      1.13e+00     0      4.98e-01]</span>
</pre></div>
</div>
<p>In the following example we compare the result of <a class="reference internal" href="pythonapi.html#partial_inv" title="partial_inv"><tt class="xref py py-func docutils literal"><span class="pre">partial_inv</span></tt></a> with
the dense full inverse of a matrix with a chordal arrow pattern.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">spmatrix</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">B</span>
<span class="go">[ 1.00e+01     0         0         0         0    ]</span>
<span class="go">[    0      1.00e+01     0         0         0    ]</span>
<span class="go">[    0         0      1.00e+01     0         0    ]</span>
<span class="go">[    0         0         0      1.00e+01     0    ]</span>
<span class="go">[ 1.00e+00  1.00e+00  1.00e+00  1.00e+00  1.00e+01]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">Bc</span><span class="p">,</span> <span class="n">nfill</span> <span class="o">=</span> <span class="n">chompack</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L2</span> <span class="o">=</span> <span class="n">chompack</span><span class="o">.</span><span class="n">cholesky</span><span class="p">(</span><span class="n">Bc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Z</span> <span class="o">=</span> <span class="n">chompack</span><span class="o">.</span><span class="n">partial_inv</span><span class="p">(</span><span class="n">L2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">chompack</span><span class="o">.</span><span class="n">sparse</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
<span class="go">[ 1.01e-01     0         0         0         0    ]</span>
<span class="go">[    0      1.01e-01     0         0         0    ]</span>
<span class="go">[    0         0      1.01e-01     0         0    ]</span>
<span class="go">[    0         0         0      1.01e-01     0    ]</span>
<span class="go">[-1.04e-02 -1.04e-02 -1.04e-02 -1.04e-02  1.04e-01]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">Binv</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Binv</span><span class="p">[::</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chompack</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">L2</span><span class="p">,</span> <span class="n">Binv</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chompack</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">L2</span><span class="p">,</span> <span class="n">Binv</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">Binv</span>
<span class="go">[ 1.01e-01  1.04e-03  1.04e-03  1.04e-03 -1.04e-02]</span>
<span class="go">[ 1.04e-03  1.01e-01  1.04e-03  1.04e-03 -1.04e-02]</span>
<span class="go">[ 1.04e-03  1.04e-03  1.01e-01  1.04e-03 -1.04e-02]</span>
<span class="go">[ 1.04e-03  1.04e-03  1.04e-03  1.01e-01 -1.04e-02]</span>
<span class="go">[-1.04e-02 -1.04e-02 -1.04e-02 -1.04e-02  1.04e-01]</span>
</pre></div>
</div>
</div>
<div class="section" id="positive-definite-completion">
<h2>Positive definite completion<a class="headerlink" href="#positive-definite-completion" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="pythonapi.html#completion" title="completion"><tt class="xref py py-func docutils literal"><span class="pre">completion</span></tt></a> function returns the Cholesky factor of the inverse
of the maximum determinant positive definite completion of a chordal
matrix.
This is the inverse operation of <a class="reference internal" href="pythonapi.html#partial_inv" title="partial_inv"><tt class="xref py py-func docutils literal"><span class="pre">partial_inv</span></tt></a>. Given a chordal
matrix <img class="math" src="_images/math/ce58e4af225c93d08606c26554caaa5ae32edeba.png" alt="Y"/>, it finds a positive definite chordal matrix <img class="math" src="_images/math/6a47ca0fe7cb276abc022af6ac88ddae1a9d6894.png" alt="X"/>
that satisfies the nonlinear equation <a href="#equation-partialinv">(2)</a>.</p>
<p>As an example, we verify that <tt class="samp docutils literal"><span class="pre">completion(Y)</span></tt> returns the
Cholesky factor <img class="math" src="_images/math/859ccf4cd60c7bc6b8fa1afc9a42dc811a826d6f.png" alt="L"/> of <img class="math" src="_images/math/019e9892786e493964e145e7c5cf7b700314e53b.png" alt="A"/>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">chompack</span><span class="o">.</span><span class="n">sparse</span><span class="p">(</span> <span class="n">chompack</span><span class="o">.</span><span class="n">completion</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span> <span class="p">)</span>
<span class="go">[ 2.26e+00     0         0         0         0         0         0         0         0         0    ]</span>
<span class="go">[    0      2.20e+00     0         0         0         0         0         0         0         0    ]</span>
<span class="go">[    0     -1.18e+00  1.10e+00     0         0         0         0         0         0         0    ]</span>
<span class="go">[    0         0      1.55e-01  1.07e+00     0         0         0         0         0         0    ]</span>
<span class="go">[    0         0         0         0      1.57e+00     0         0         0         0         0    ]</span>
<span class="go">[    0         0         0         0         0      2.33e+00     0         0         0         0    ]</span>
<span class="go">[    0         0         0         0         0         0      1.28e+00     0         0         0    ]</span>
<span class="go">[    0         0         0         0         0         0         0      9.95e-01     0         0    ]</span>
<span class="go">[    0         0         0         0         0      6.04e-01  1.60e+00  1.30e+00  6.49e-01     0    ]</span>
<span class="go">[    0         0         0         0         0         0      1.64e-01 -7.94e-01  1.24e+00  1.42e+00]</span>
</pre></div>
</div>
</div>
<div class="section" id="factored-hessian">
<h2>Factored Hessian<a class="headerlink" href="#factored-hessian" title="Permalink to this headline">¶</a></h2>
<p>Consider the log-det barrier</p>
<div class="math">
<p><img src="_images/math/db5f18450ea040344846c791bca1dc511156cfc8.png" alt="f(X) = -\log\det(X)" /></p>
</div><p>as a function of the positive definite matrices with a given chordal
pattern.   The Hessian of <img class="math" src="_images/math/bb2c93730dbb48558bb3c4738c956c4e8f816437.png" alt="f"/>, at a positive definite <img class="math" src="_images/math/6a47ca0fe7cb276abc022af6ac88ddae1a9d6894.png" alt="X"/>, is
a linear mapping that maps chordal matrices to chordal matrices.
We use the notation</p>
<div class="math">
<p><img src="_images/math/94710e78c13c23dc6e8146a51dee4575861c562b.png" alt="\mathcal H_X(U) = \mathrm{proj}(X^{-1}UX^{-1})" /></p>
</div><p>to denote this mapping.  The <a class="reference internal" href="pythonapi.html#hessian" title="hessian"><tt class="xref py py-func docutils literal"><span class="pre">hessian</span></tt></a> function evaluates the
Hessian in a factored form</p>
<div class="math">
<p><img src="_images/math/65fa8bc5622da0b55c136dcab75dd8ce908f7fc3.png" alt="{\cal H}_X(U) = {\cal G}_X^\mathrm{adj}( {\cal G}_X( U ))." /></p>
</div><p>It can also be used to evaluate the inverse of these operations.</p>
<p>In the following example, we compute <img class="math" src="_images/math/6c34638924e10b8f5c5d311f57468ce6127b8acc.png" alt="\mathcal G_A(U)"/> for the
matrix <img class="math" src="_images/math/019e9892786e493964e145e7c5cf7b700314e53b.png" alt="A"/> in <a href="#equation-chordal_X">(1)</a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">U</span> <span class="o">=</span> <span class="n">chompack</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="n">Ac</span><span class="p">,</span> <span class="n">matrix</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chompack</span><span class="o">.</span><span class="n">hessian</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="p">[</span><span class="n">U</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">chompack</span><span class="o">.</span><span class="n">sparse</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
<span class="go">[ 4.12e-01     0         0         0         0         0         0         0         0         0    ]</span>
<span class="go">[    0      3.90e-01     0         0         0         0         0         0         0         0    ]</span>
<span class="go">[    0         0     -6.15e+00     0         0         0         0         0         0         0    ]</span>
<span class="go">[    0         0     -2.93e+00  2.02e+00     0         0         0         0         0         0    ]</span>
<span class="go">[    0         0      1.30e+00     0      3.67e-01     0         0         0         0         0    ]</span>
<span class="go">[ 1.28e+00     0         0         0         0      3.90e+00     0         0         0         0    ]</span>
<span class="go">[    0         0         0         0         0      1.14e+00  1.35e+00     0         0         0    ]</span>
<span class="go">[    0         0     -6.01e-01     0         0         0         0      1.22e+00     0         0    ]</span>
<span class="go">[    0         0         0         0         0         0         0         0      8.06e-01     0    ]</span>
<span class="go">[    0         0      1.56e+00  1.92e+00     0         0         0      1.49e+00     0      4.97e+00]</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="pythonapi.html#hessian" title="hessian"><tt class="xref py py-func docutils literal"><span class="pre">hessian</span></tt></a> function overwrites <cite>U</cite> with the result. Note that
we used <a class="reference internal" href="pythonapi.html#project" title="project"><tt class="xref py py-func docutils literal"><span class="pre">project</span></tt></a> to create the <cite>U</cite> chordal matrix.
This ensures that the sparsity pattern of the projection is treated as
identical to the sparsity pattern of <cite>X</cite>.</p>
<p>As another example, we check the relation</p>
<div class="math">
<p><img src="_images/math/1bfe4604df9470711c675ad5b548ea215a7630c0.png" alt="\mathcal H_A(A) = \mathrm{proj}(A^{-1})," /></p>
</div><p>which follows from the definition of the Hessian and the projected inverse.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">U</span> <span class="o">=</span> <span class="n">chompack</span><span class="o">.</span><span class="n">project</span><span class="p">(</span><span class="n">Ac</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chompack</span><span class="o">.</span><span class="n">hessian</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="p">[</span><span class="n">U</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chompack</span><span class="o">.</span><span class="n">hessian</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="p">[</span><span class="n">U</span><span class="p">],</span> <span class="n">adj</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">chompack</span><span class="o">.</span><span class="n">sparse</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
<span class="go">[ 4.47e-01     0         0         0         0         0         0         0         0         0    ]</span>
<span class="go">[    0      1.95e-01     0         0         0         0         0         0         0         0    ]</span>
<span class="go">[    0         0      4.19e+00     0         0         0         0         0         0         0    ]</span>
<span class="go">[    0         0     -6.22e+00  1.04e+01     0         0         0         0         0         0    ]</span>
<span class="go">[    0         0     -1.08e+00     0      4.64e-01     0         0         0         0         0    ]</span>
<span class="go">[ 4.52e-01     0         0         0         0      8.44e-01     0         0         0         0    ]</span>
<span class="go">[    0         0         0         0         0     -1.24e-01  8.80e-01     0         0         0    ]</span>
<span class="go">[    0         0     -5.12e+00     0         0         0         0      6.86e+00     0         0    ]</span>
<span class="go">[    0         0         0         0         0         0         0         0      4.03e-01     0    ]</span>
<span class="go">[    0         0     -9.52e-01  1.64e+00     0         0         0      1.13e+00     0      4.98e-01]</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
    <h3>Contents</h3>
    <ul>
    <l1><a href="index.html">Top</a></li>
    <ul>
    <li><a href="copyright.html">Copyright and License</a></li>
    <li><a href="terminology.html">Terminology</a></li>
    <li><a href="pythonapi.html">Python Interface</a></li>
    <li><a href="#">Python Examples</a></li>
    <li><a href="capi.html">C Interface</a></li>
    <li><a href="installation.html">Installation Guide</a></li>
    <li><a href="download.html">Download</a></li>
    </ul>
    </ul>
        <h3>This page</h3> <ul>
<li><a class="reference internal" href="#">Python Examples</a><ul>
<li><a class="reference internal" href="#chordal-matrices">Chordal matrices</a></li>
<li><a class="reference internal" href="#cholesky-factorization">Cholesky factorization</a></li>
<li><a class="reference internal" href="#partial-inverse">Partial inverse</a></li>
<li><a class="reference internal" href="#positive-definite-completion">Positive definite completion</a></li>
<li><a class="reference internal" href="#factored-hessian">Factored Hessian</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="pythonapi.html"
                        title="previous chapter">Python Interface</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="capi.html"
                        title="next chapter">C Interface</a></p>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="capi.html" title="C Interface"
             >next</a></li>
        <li class="right" >
          <a href="pythonapi.html" title="Python Interface"
             >previous</a> |</li>
        <li><a href="index.html">CHOMPACK - Chordal Matrix Package</a> </li> 
      </ul>
    </div>
    <div class="footer">
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker("UA-2894407-1");
pageTracker._trackPageview();
} catch(err) {}
</script>
  </body>
</html>